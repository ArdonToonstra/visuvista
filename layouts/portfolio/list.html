{{ define "main" }}
<section class="section pt-14">
  <div class="container">
    <div class="row justify-center">
      <div class="lg:col-8 text-center">
        <h1 class="mb-4">{{ .Title }}</h1>
        <p class="mb-8 text-lg">{{ .Params.description }}</p>
        <p class="mb-8 text-sm text-gray-600">
          {{ if eq .Site.Language.Lang "es" }}
            Proyectos en la provincia de Alicante, España
          {{ else if eq .Site.Language.Lang "nl" }}
            Projecten in de provincie Alicante, Spanje
          {{ else }}
            Projects in Alicante province, Spain
          {{ end }}
        </p>
      </div>
    </div>

    <!-- Featured Projects -->
    {{ with .Params.featured_projects }}
      <div class="row gy-4">
        {{ range . }}
          <div class="col-12 mb-12">
            <div class="project-card bg-white rounded-lg shadow-lg overflow-hidden">
              
              <!-- Project Header -->
              <div class="p-6 border-b">
                <div class="row items-center">
                  <div class="md:col-8">
                    <h3 class="text-h4 mb-2">{{ .title }}</h3>
                    <p class="text-gray-600 mb-3">{{ .description }}</p>
                    <div class="flex flex-wrap gap-2 mb-3">
                      {{ range .services_used }}
                        <span class="px-3 py-1 bg-primary/10 text-primary text-sm rounded-full">{{ . }}</span>
                      {{ end }}
                    </div>
                  </div>
                  <div class="md:col-4 text-right">
                    <p class="text-sm text-gray-500">
                      <i class="fa-solid fa-location-dot me-1"></i>
                      {{ .location }}
                    </p>
                  </div>
                </div>
              </div>

              <!-- Project Content -->
              <div class="p-6">
                {{ if eq .type "3d_tour" }}
                  <!-- 3D Tour Iframe -->
                  <div class="mb-4">
                    <h4 class="mb-3">
                      {{ if eq $.Site.Language.Lang "es" }}
                        Tour Virtual Interactivo 3D
                      {{ else if eq $.Site.Language.Lang "nl" }}
                        Interactieve 3D Virtuele Tour
                      {{ else }}
                        Interactive 3D Virtual Tour
                      {{ end }}
                    </h4>
                    <div class="iframe-container rounded-lg overflow-hidden shadow-md">
                      <iframe 
                        id="{{ .iframe_name }}" 
                        name="{{ .title }}" 
                        src="{{ .iframe_src }}" 
                        frameBorder="0" 
                        width="100%" 
                        height="400px" 
                        scrolling="no" 
                        allowvr="yes" 
                        allow="vr; xr; accelerometer; gyroscope; autoplay;" 
                        allowFullScreen="false" 
                        webkitallowfullscreen="false" 
                        mozallowfullscreen="false" 
                        loading="eager">
                      </iframe>
                    </div>
                    <p class="text-sm text-gray-500 mt-2">
                      {{ if eq $.Site.Language.Lang "es" }}
                        Usa el ratón para navegar, o tu teléfono para experiencia VR
                      {{ else if eq $.Site.Language.Lang "nl" }}
                        Gebruik je muis om te navigeren, of je telefoon voor VR ervaring
                      {{ else }}
                        Use mouse to navigate, or your phone for VR experience
                      {{ end }}
                    </p>
                  </div>

                  <!-- Device Motion Script for VR -->
                  <script>
                    var pano_iframe_name = "{{ .iframe_name }}";
                    window.addEventListener("devicemotion", function(e){ 
                      var iframe = document.getElementById(pano_iframe_name); 
                      if (iframe) iframe.contentWindow.postMessage({ 
                        type:"devicemotion", 
                        deviceMotionEvent:{ 
                          acceleration:{ 
                            x:e.acceleration.x, 
                            y:e.acceleration.y, 
                            z:e.acceleration.z 
                          }, 
                          accelerationIncludingGravity:{ 
                            x:e.accelerationIncludingGravity.x, 
                            y:e.accelerationIncludingGravity.y, 
                            z:e.accelerationIncludingGravity.z 
                          }, 
                          rotationRate:{ 
                            alpha:e.rotationRate.alpha, 
                            beta:e.rotationRate.beta, 
                            gamma:e.rotationRate.gamma 
                          }, 
                          interval:e.interval, 
                          timeStamp:e.timeStamp 
                        } 
                      }, "*"); 
                    });
                  </script>

                {{ else if eq .type "gallery" }}
                  <!-- Image Gallery -->
                  <div class="row gy-4">
                    {{ range .images }}
                      <div class="md:col-6">
                        <div class="image-container rounded-lg overflow-hidden shadow-md">
                          {{ partial "image" (dict "Src" . "Alt" "Portfolio image" "Class" "w-full h-64 object-cover" "DisplayXL" "600x" "DisplayLG" "500x" "DisplayMD" "400x") }}
                        </div>
                      </div>
                    {{ end }}
                  </div>
                {{ end }}
              </div>
            </div>
          </div>
        {{ end }}
      </div>
    {{ end }}

    <!-- Call to Action -->
    <div class="row justify-center mt-12">
      <div class="lg:col-8 text-center">
        <div class="bg-gradient p-8 rounded-lg">
          <h3 class="mb-4">
            {{ if eq .Site.Language.Lang "es" }}
              ¿Quieres un proyecto similar?
            {{ else if eq .Site.Language.Lang "nl" }}
              Wilt u een soortgelijk project?
            {{ else }}
              Want a similar project?
            {{ end }}
          </h3>
          <p class="mb-6">
            {{ if eq .Site.Language.Lang "es" }}
              Contáctanos para discutir tu próximo proyecto de visualización
            {{ else if eq .Site.Language.Lang "nl" }}
              Neem contact met ons op om uw volgende visualisatieproject te bespreken
            {{ else }}
              Contact us to discuss your next visualization project
            {{ end }}
          </p>
          <a href="/contact" class="btn btn-primary">
            {{ if eq .Site.Language.Lang "es" }}
              Solicitar Cotización
            {{ else if eq .Site.Language.Lang "nl" }}
              Offerte Aanvragen
            {{ else }}
              Request Quote
            {{ end }}
          </a>
        </div>
      </div>
    </div>
  </div>
</section>
{{ end }}